# Домашнее задание к уроку 8. #   
1. В Yandex-Cloud от выполнения первого дз у меня осталась виртуальная машина и установленный PostgreSQL 15.   
![Шаг4](/4_1_OldVM.jpg)  
1. Создала базу данных для тестов командой pgbench -i postgres   
![Шаг4](/8_1_pgbench.jpg)  
1. Запустила команду pgbench -c8 -P 6 -T 60 -U postgres postgres   
![Шаг4](/8_2_pgbench.jpg)    
Среднее tps 620.86.   
1. Применила параметры настройки PostgreSQL из прикрепленного к материалам занятия файла:   
![Шаг4](/8_2_params.jpg)  
Редактирование конфигурационного файла postgresql.conf   
![Шаг4](/8_3_edit_conf_1.jpg)  
![Шаг4](/8_4_edit_conf_2.jpg)  
Перезагрузка кластера:  
![Шаг4](/8_5_edit_conf_3.jpg)  
![Шаг4](/8_6_edit_conf_4.jpg)  
1. Протестировала заново командой pgbench -c8 -P 6 -T 60 -U postgres postgres   
![Шаг4](/8_7_edit_conf_5.jpg)  
Среднее tps стало 528.35. При данных параметрах конфигурационного файла кластер за 60 секунд смог обработать 31,7 тыс транзакций, среднее время ожидания стало 15.13 ms.   
Производительность снизилась, время задержек возросло.  
1. Создала таблицу с текстовым полем и заполнить случайными или сгенерированными данными в размере 1млн строк.   
![Шаг4](/8_10_textf_1.jpg)  
![Шаг4](/8_11_textf_2.jpg)  
1. Посмотрела размер файла с таблицей.   
![Шаг4](/8_12_textf_3.jpg)  
1. Обновила все строчки таблицы добавляя к каждой строчке любой символ 5 раз.  
![Шаг4](/8_13_textf_4.jpg)  
Количество мертвых строчек в таблице и время работы последнего автовакуума отмечены красным на скрине.   
1. Подождала некоторое время, проверяя, пришел ли автовакуум.   
![Шаг4](/8_14_textf_50.jpg)  
Автовакуум прошел. Количество мертвых строк стало 0. Отмечено красным.  
1. Обновила все строчки таблицы добавляя к каждой строчке любой символ 5 раз.   
![Шаг4](/8_15_textf_6.jpg)  
1. Посмотрела размер файла с таблицей.   
![Шаг4](/8_16_textf_7.jpg)  
Размер файла с таблицей не изменился, т.к. на данной таблице мы уже проводили апдейт всех строк 5 раз и место под эти апдейты уже выделилось. Автовакуум отрабатывал после предыдущих апдейтов, поэтому новые апдейты записались на освобожденное место без увеличения размера файла.   
1. Отключила автовакуум на конкретной таблице tst_vacuum и обновила все строчки таблицы добавляя к каждой строчке любой символ 10 раз.   
![Шаг4](/8_17_textf_8.jpg)  
1. Посмотрела размер файла с таблицей.   
![Шаг4](/8_18_textf_9.jpg)  
Размер файла увеличился, т.к. было запущено 10 апдейтов, в результате в таблице стало 1млн живых строк и 10млн мертвых строк.    
## Задание со звездочкой* Написать анонимную процедуру, в которой в цикле 10 раз обновятся все строчки в искомой таблице. ##  
Не совсем поняла, в чем смысл звездочки. Вроде бы в этом задании нет сложности. Или может быть не поняла суть задания?   
Анонимный блок для апдейта таблицы 10 раз.   
![Шаг4](/8_19_add.jpg)  
